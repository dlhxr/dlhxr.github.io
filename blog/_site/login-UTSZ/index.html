<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="dlhxr" />
    <title>模拟登陆UTSZ并保持在线（VBS） | dlhxr</title>
    <link rel="shortcut icon" href="/blog/favicon.ico">
    <link rel="stylesheet" href="/blog/media/css/style.css">
	<link rel="stylesheet" href="/blog/media/css/prettify.css">         <!-- Prettify -->
    <link rel="stylesheet" href="/blog/media/css/backtop.css">                 <!-- Back Top 1/3 -->
    <script type="text/javascript" src="/blog/media/js/backtop.js"></script>   <!-- Back Top 2/3 -->
    <script type="text/javascript" src="/blog/media/js/prettify.js"></script>  <!-- Prettify -->
	<script type="text/javascript" src="/blog/media/js/lang-vb.js"></script><!-- Prettify VB-->
	<script type="text/javascript" src="/blog/media/js/jquery-1.9.1.min.js"></script>
	<script type="text/javascript" src="/blog/media/js/timespan.js"></script>

  </head>

  <body onLoad="setInterval(setTimeSpan,1000);prettyPrint()">
    <div id="container">
      <div id="main" role="main">
        <header>
        <h1>模拟登陆UTSZ并保持在线（VBS）</h1>
        </header>
        <nav>
        <span><a title="home page" class="" href="/blog/">Home</a></span>
        <span><a title="about" class="" href="/blog/sub/about/">About</a></span>
        <span><a title="guestbook" class="" href="/blog/sub/guestbook/">Guestbook</a></span>
        <span><a title="categories" class="" href="/blog/sub/categories/">Categories</a></span>
        <span><a title="tags" class="" href="/blog/sub/tags/">Tags</a></span>
        <span><a title="links" class="" href="/blog/sub/links/">Links</a></span>
        </nav>
        <article class="content">
        <span class="time">
  <time datetime="2014-08-01">2014-08-01</time>
</span>


<span class="author">
  /
  <a href="/blog/">dlhxr</a>
</span>


<span class="tags">
  /
  
  <a href="/blog/sub/tags/#VBS" title="VBS">#VBS</a>
  
</span>


<!-- 开头提示文章末尾有二维码 -->
<section class="meta">
  <span><p align="left">【页尾可见本文二维码】</p></span>
</section>

<section class="post">
<p>大学城的网络很坑爹，经常自动掉线，故写这么个VBS脚本随时保持在线~</p>

<p>用户名是校园卡号，密码是经过base64加密过的~</p>
<pre class="prettyprint lang-vb linenums">
On Error Resume Next
REM Ignore error and prevent the vbs killing itself
Dim connect,test,html,check,userid,userpwd,interval
REM Define variables.

REM Please replace the following variables with yours
userid=XXXX
REM Your student ID
userpwd=XXXX
REM Your password encrypted by Base64
interval=30
REM The interval to check connection. (In seconds)

connect="http://219.223.254.55/portal/login.jsp?userName="&amp;userid&amp;"&amp;userPwd="&amp;userpwd&amp;"&amp;language"
REM Set website to connect.
test="http://www.baidu.com"
REM To test whether you are online.

Set html = CreateObject("Msxml2.ServerXMLHTTP")
REM Create a new XMLHTTP variable
Set check = new RegExp
check.pattern = "百度"
REM To grab the keywork to test whether you are online.

do
	html.open "GET", test,false
	if html.send then
		exit do
		REM Not connected to UTSZ, PKU, or Dorm router.
	end if
	if check.test(html.responseText) &lt;&gt; "True" then
		REM	check whether the internet drops.
		html.open "GET", connect,false
		html.send
		REM if it drops, reconnect.
	end if
	wscript.sleep(1000*interval)
	REM wait for 1 minute to recheck.
loop
msgbox "Please check you network connection!"
</pre>

<p>01 Aug 2014</p>

</section>

<!-- Add Auto QR Code Generator -->
<!--liantu api for QR code-->
<script type="text/javascript">  
  thisURL  = document.URL;  
  strwrite = "<p align='center'><img src='http://qr.liantu.com/api.php?w=150&text=" + thisURL + "'/>（传送门）</p>";
  document.write( strwrite ); 
</script>



<!--Google Api for QR Code
<script type="text/javascript">  
  thisURL  = document.URL;  
  strwrite = "<p align='center'><img src='http://chart.apis.google.com/chart?chs=120x120&amp;cht=qr&amp;chld=|1&amp;chl=" + thisURL + "' width='120' height='120' alt='QR Code'/>（传送门）</p>";
   document.write( strwrite ); 
</script>
-->
<!-- QR Code End -->

<section class="meta">
<span>
<p align="center">(转载本站文章请注明作者和出处，请勿用于任何商业用途)</p>
</span>

<br/>

<!-- Baidu Botton (Part 1/2)-->
<div class="bdsharebuttonbox"><a href="#" class="bds_more" data-cmd="more"></a><a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a><a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a><a href="#" class="bds_tqq" data-cmd="tqq" title="分享到腾讯微博"></a><a href="#" class="bds_renren" data-cmd="renren" title="分享到人人网"></a><a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a></div>
<!-- Baidu Botton End -->

<span>
	<a  href="/blog/login-BCZX" class="pageNav"  >Previous</a>

	&nbsp;&nbsp;&nbsp;

	<a  href="/blog/VPS-shadowsocks" class="pageNav"  >Next</a>
  
</span>
<hr>
<span class="author">
  <a href="/blog/">dlhxr</a>
</span>
<span class="time">
  /
  <time datetime="2014-08-01">2014-08-01</time>
</span>
<br />
<span class="license">
  Published under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">(CC) BY-NC-SA</a>
</span>


<span class="categories">
  in categories
  
  <a href="/blog/sub/categories/#vbs" title="vbs">vbs</a>&nbsp;
  
</span>



<span class="tags">
  tagged with 
  
  <a href="/blog/sub/tags/#VBS" title="VBS">VBS</a>&nbsp;
  
</span>


</section>

<!-- 友言JS代码 start (一个网页只需插入一次) -->
<div id="uyan_frame"></div>
<script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=1953111"></script>
<!-- 友言JS代码 end -->


<!-- Baidu Botton (Part 2/2) -->
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
<!-- Baidu Botton End -->


        </article>
      </div>

      <footer>
		
        <p><small>Powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a> & <a href="http://www.gitcafe.com">GitCafe</a> | Copyright &copy; 2014 ~ 2014 by <a href="/blog/sub/about/">dlhxr</a> | <span class="label label-info" id="timeSpan"></span></small></p>
      </footer>
    </div>

    <!-- Back Top 3/3 -->
    <div id="back-top">
        <a href="#top" title="回到顶部"></a>
    </div>
    <!-- ++++++++++++ -->

  </body>
</html>
